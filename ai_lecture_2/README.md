# 🍽️ Агентная система составления персонального рациона питания

Интеллектуальная система на базе LangChain и LangGraph для создания персонализированных планов питания на основе физических параметров и пищевых предпочтений пользователя.

## 📋 Описание

Система использует три специализированных AI-агента:

1. **Nutrition Agent** - Анализирует физические показатели (пол, вес, рост, возраст) и рассчитывает:
   - Базальный метаболизм (BMR) по формуле Миффлина-Сан Жеора
   - Дневную норму калорий с учетом цели
   - Оптимальное соотношение макронутриентов

2. **Preferences Agent** - Анализирует пищевые предпочтения и составляет:
   - Список разрешенных продуктов
   - Список запрещенных продуктов
   - Рекомендации по выбору продуктов

3. **Final Agent** - Объединяет анализы и создает:
   - Детальный план питания на неделю
   - 4-5 приемов пищи в день
   - Калорийность и макронутриенты для каждого приема
   - Экспорт в JSON формате

## 🏗️ Архитектура

```
┌─────────────────┐
│  User Input     │
│  (goal, weight, │
│  height, prefs) │
└────────┬────────┘
         │
         ▼
┌─────────────────────────────────┐
│      LangGraph Workflow         │
│                                 │
│  ┌──────────────────────────┐  │
│  │  Nutrition Agent         │  │
│  │  (Physical Analysis)     │  │
│  └──────────┬───────────────┘  │
│             │                   │
│             ▼                   │
│  ┌──────────────────────────┐  │
│  │  Preferences Agent       │  │
│  │  (Food Analysis)         │  │
│  └──────────┬───────────────┘  │
│             │                   │
│             ▼                   │
│  ┌──────────────────────────┐  │
│  │  Final Agent             │  │
│  │  (Weekly Plan Creator)   │  │
│  └──────────┬───────────────┘  │
└─────────────┼───────────────────┘
              │
              ▼
┌─────────────────────────────────┐
│  Weekly Meal Plan (JSON)        │
│  - 7 days                       │
│  - 4-5 meals per day            │
│  - Calories & macros            │
└─────────────────────────────────┘
```

## 🗂️ Структура проекта

```
ai_lecture_2/
├── src/
│   ├── agents/
│   │   ├── __init__.py
│   │   ├── nutrition_agent.py      # Агент анализа физических показателей
│   │   ├── preferences_agent.py    # Агент анализа предпочтений
│   │   └── final_agent.py          # Финальный агент создания плана
│   ├── graph/
│   │   ├── __init__.py
│   │   └── workflow.py             # LangGraph workflow
│   ├── models/
│   │   ├── __init__.py
│   │   └── schemas.py              # Pydantic схемы данных
│   └── utils/
│       ├── __init__.py
│       └── config.py               # Конфигурация
├── main.py                         # Точка входа в приложение
├── requirements.txt                # Зависимости
├── .env.example                    # Пример конфигурации
└── README.md                       # Документация
```

## 🚀 Установка и запуск

### 1. Клонирование и настройка окружения

```bash
# Перейдите в директорию проекта
cd ai_lecture_2

# Активируйте виртуальное окружение (если уже создано)
source venv/bin/activate  # для macOS/Linux
# или
venv\Scripts\activate  # для Windows

# Установите зависимости
pip install -r requirements.txt
```

### 2. Настройка API ключа

Получите API ключ OpenAI:
1. Перейдите на [OpenAI Platform](https://platform.openai.com/api-keys)
2. Создайте новый API ключ

Создайте файл `.env` в корне проекта:

```bash
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. Запуск приложения

```bash
# Интерактивный режим
python main.py

# Или запустите пример с тестовыми данными
# Откройте main.py и раскомментируйте строку: run_example()
```

## 💻 Использование

### Интерактивный режим

При запуске программа попросит ввести:

1. **Цель**: похудеть, набрать вес или поддерживать
2. **Пол**: мужской или женский
3. **Вес**: в килограммах
4. **Рост**: в сантиметрах
5. **Возраст**: в годах
6. **Предпочтения**: веган, вегетарианец, без глютена, без лактозы и т.д.

### Программное использование

```python
from src.models.schemas import UserInput
from src.graph.workflow import MealPlannerWorkflow

# Создаем входные данные
user_input = UserInput(
    goal="lose_weight",      # lose_weight, gain_weight, maintain
    gender="male",           # male, female
    weight=85.0,
    height=180.0,
    age=30,
    preferences="веган"
)

# Создаем и запускаем workflow
workflow = MealPlannerWorkflow()
final_state = workflow.run(user_input)

# Получаем план
meal_plan = final_state.final_plan
```

## 📊 Выходные данные

Система генерирует JSON файл с недельным планом питания:

```json
{
  "week_plan": [
    {
      "day": "Понедельник",
      "meals": [
        {
          "name": "Завтрак",
          "time": "08:00",
          "foods": ["Овсянка 80г", "Банан 1шт", "Миндаль 20г"],
          "calories": 450,
          "protein_g": 12,
          "carbs_g": 65,
          "fats_g": 15
        }
      ],
      "total_calories": 1800,
      "total_protein_g": 120,
      "total_carbs_g": 200,
      "total_fats_g": 60
    }
  ],
  "summary": "Сбалансированный веганский рацион..."
}
```

## 🔧 Технологии

- **LangChain** - фреймворк для работы с LLM
- **LangGraph** - создание графов состояний для агентных систем
- **OpenAI GPT-4 Turbo** - мощная языковая модель
- **Pydantic** - валидация данных и схемы
- **Python 3.9+** - язык программирования

## 📝 Поддерживаемые диеты

- Веган
- Вегетарианец
- Без глютена
- Без лактозы
- Палео
- Кето
- И другие (просто опишите свои предпочтения)

## 🎯 Цели

- **Похудение**: дефицит калорий, акцент на белки
- **Набор массы**: профицит калорий, больше углеводов
- **Поддержание**: баланс калорий

## 🤝 Вклад в проект

Проект создан в образовательных целях как MVP агентной системы.

## 📄 Лицензия

MIT License

## 👨‍💻 Автор

Создано с использованием LangChain и LangGraph

